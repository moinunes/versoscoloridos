<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Teste de Intersection Observer com AdSense</title>
</head>
<body>

<div class="div_observada" style="height: 200px; background-color: lightblue;">
    <p>Div Observada</p>
</div>

<div class="div_publicidade" style="height: 100px; background-color: lightcoral;">
    <p>Área de Anúncio</p>
</div>

<script>
document.addEventListener("DOMContentLoaded", function() {
    const divObservada = document.querySelector('.div_observada');
    const divPublicidade = document.querySelector('.div_publicidade');

    const opcoes = {
        root: null,
        rootMargin: '0px',
        threshold: 0.5
    };

    const observer = new IntersectionObserver(function(entries, observer) {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                carregarAnuncio();
                observer.unobserve(entry.target);
            }
        });
    }, opcoes);

    observer.observe(divObservada);

    function carregarAnuncio() {
        const codigoAdSense = `
            <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
            <ins class="adsbygoogle"
                 style="display:block"
                 data-ad-client="ca-pub-XXXXXXXXXXXX"
                 data-ad-slot="XXXXXXXXXX"
                 data-ad-format="auto"
                 data-full-width-responsive="true"></ins>
            <script>
                 (adsbygoogle = window.adsbygoogle || []).push({});
            </script>
        `;
        divPublicidade.innerHTML = codigoAdSense;
    }
});
</script>

</body>
</html>